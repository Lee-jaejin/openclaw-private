#!/usr/bin/env bash
# SSH bridge to host macOS imsg CLI from inside the container.
# Requires: SSH key at /home/node/.ssh/openclaw_imsg
# See docs/setup-guide.md for setup instructions.
set -euo pipefail

IMSG_SSH_USER="${IMSG_SSH_USER:-$(whoami)}"
IMSG_BIN="${IMSG_BIN:-/opt/homebrew/bin/imsg}"

exec /usr/bin/ssh -o BatchMode=yes -o ConnectTimeout=5 -o StrictHostKeyChecking=accept-new \
  -i /home/node/.ssh/openclaw_imsg -T \
  "${IMSG_SSH_USER}@host.containers.internal" \
  "${IMSG_BIN}" "$@"
