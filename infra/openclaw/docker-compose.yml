version: "3.9"

services:
  openclaw:
    build:
      context: ../../openclaw
      dockerfile: ../../infra/openclaw/Dockerfile
    image: openclaw:local
    container_name: openclaw
    restart: unless-stopped
    ports:
      - "18789:18789"
    environment:
      - OLLAMA_HOST=http://host.containers.internal:11434
      - NODE_ENV=production
    env_file:
      - ../../.env
    volumes:
      - ../../config/openclaw.json:/home/node/.openclaw/openclaw.json:ro
      - openclaw-sessions:/home/node/.openclaw/sessions
    security_opt:
      - no-new-privileges:true
    cap_drop:
      - ALL
    extra_hosts:
      - "host.containers.internal:host-gateway"
    networks:
      - openclaw-net

networks:
  openclaw-net:
    driver: bridge

volumes:
  openclaw-sessions:
